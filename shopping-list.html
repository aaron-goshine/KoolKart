<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Goshine test pages</title>
<style>
*{padding:0px; margin:0px; list-style:none; font-family:Verdana, Geneva, sans-serif; font-size:98%}
li{ }
#selectList { width:400px; background-color:#F93; }
#selectList li {border-bottom:1px solid black; width:80px; margin-bottom:5px; margin-right:10px;
 float:left; cursor:pointer; height:140px; border:2px solid gray; text-align:center; padding:10px; background-color:#FFF; }
#selectList li img{ display:inline;}
#selectList li img{}
.listname{ font-size:10px;}
.price{ font-size:12px}
#mainList {border-left:2px solid Gray; border-right:2px solid Gray; border-top:2px solid Gray; width:250px;}
#mainList li {border-bottom:2px solid Gray; width:240px; padding-left:10px; padding-bottom:10px; position:relative; background-color:Cornsilk;}
#mainList li h4 {padding:0px; margin:0px 0px 5px 0px;}
#mainList li input { display:inline-block; margin-right:5px;}
#mainList li span {display:inline-block; width:250px;}
#mainList li img{display:inline-block; position:absolute; right:5px; top:5px;cursor:pointer;}
.qntlable{display:inline-block;}
.qntField{display:inline-block; width:60px;}
/* -- */
.colom{ margin:20px 0px 0px 20px; float:left; width:350px;  }
.colomone{ margin:20px 0px 0px 20px; float:left; width:260px;}
#bettingTotal{ font-size:12px; font-weight:bold;}
.note{ font-size:10px;color:gray;}
.hlightBg{ background-color:#FC0!important;}
</style>

<script type="text/javascript">
//-- I will try to ad more comment as we go along 
//-- list is the my global data source  with pulled in or serialise

var list = {
    id01: {
        id: "id01",
        name: 'Magical Mix',
        title: 'Magical Mix',
        value: "3.60",
        imageName: "Magical-Mix.jpg",
        prodDesc: "Perfect Description"
    },
    id02: {
        id: "id02",
        name: 'Empty Box',
        title: 'Empty Box',
        value: "9.60",
        imageName: "Empty-Box.jpg",
        prodDesc: "Less is more"
    },
    id03: {
        id: "id03",
        name: 'Good Gears',
        title: 'Good Gears',
        value: "101.60",
        imageName: "Good-Gears.jpg",
        prodDesc: "Get in the right gear"
    },
    id04: {
        id: "id04",
        name: "Loud Alarmers",
        title: "Loud Alarmers",
        value: "5.60",
        imageName: "Loud-Alermers.jpg",
        prodDesc: "Loud is always better"
    },
    id05: {
        id: "id05",
        name: 'Perfect Gift',
        title: 'Perfect Gift',
        value: "1.60",
        imageName: "Perfect-Gift.jpg",
        prodDesc: "A perfect Gift is what you expectected"
    },
    id06: {
        id: "id06",
        name: "Piggy Bank",
        title: "Piggy Bank",
        value: "5.60",
        imageName: "Piggy-Bank.jpg",
        prodDesc: "This Piggy Bank is perfect for big coins"
    },
};
/*--
ListItemsClass is the class that  will
be instantiated  to create  items that are 
added tio the Shopping list
takes two @param1 obj is reference to a DOM object
@param2 accepts an instance of the collectionManager
that is responsible for managing  each items in the shopping list

*/
function ListItemsClass(obj, collectionManager) {
	

		
    //-- properties
    var dis = this;
    this.item = document.createElement("li");

    this.id = obj.id;
    this.name = obj.name;
    this.title = obj.title;
    this.value = obj.value;

    this.value = obj.value;
	this.quantyValueCount = 0;
    this.checkBoxStatus = false;
    this.item.id = obj.id;
    this.title = document.createElement("h4");
    
	collectionManager.appMainHandler.utilCreateNode( this.title,obj.title);
    //
    this.setValue = function (value) {
    this.quantyValueCount = value;
	collectionManager.appMainHandler.utilCreateNode( this.valueLabel,value);
       // this.valueLabel.innerHTML = value;
    }

    this.checkBox = document.createElement("input");
    this.checkBox.type = "checkbox";

    this.quanty = document.createElement("input");
    this.quanty.type = "text";
    this.quanty.className = "qntField";
    this.quanty.value = 1;


    this.quantyLabel = document.createElement("label");
    this.quantyLabel.className = "qntlable";
    //this.quantyLabel.innerHTML = "Quantity:";
	collectionManager.appMainHandler.utilCreateNode( this.quantyLabel,"Quantity:");

    this.label = document.createElement("label");
    
    collectionManager.appMainHandler.utilCreateNode(this.label,obj.name); 
    this.valueLabel = document.createElement("span");
    
   collectionManager.appMainHandler.utilCreateNode(this.valueLabel,obj.value);
    this.deleteBtn = document.createElement("img");
    this.deleteBtn.src = "../images/deleteBtn.png";
	
	this.quantityPlus = function (){
		this.quanty.value = parseInt(this.quanty.value)+1;
		//--
		dis.setValue(collectionManager.CurrencyFmt(dis.value * collectionManager.oneFactor(parseInt(dis.quanty.value))));
            collectionManager.itemvalueAdded(true);
		}
	
	this.quantyValue = function (){
		
	return  collectionManager.oneFactor( parseInt(this.quanty.value)) * this.value; 
		
		}
		

    this.quanty.onblur = function () {
	//alert(dis.quantyValue());



if (isNaN(dis.quanty.value) === false && dis.quanty.value >0 ) {

            dis.setValue(collectionManager.CurrencyFmt(dis.value * collectionManager.oneFactor(parseInt(dis.quanty.value))));
            collectionManager.itemvalueAdded(true);
        } 
		
		
		
		if (dis.quanty.value  == 0 ){
			
			remover();
			}

    }

    this.checkBox.onclick = function boxChecked(event) {
        if (  this.checkBox.checked == true) {

            dis.checkBoxStatus = true;
			collectionManager.addCheck(obj.id, true);
			
		

        } else {

            dis.checkBoxStatus = false;

            collectionManager.addCheck(obj.id, false);

        }

    }

    //--



    function remover() {

        collectionManager.removeItem(obj.id);
    }

    this.deleteBtn.onclick = remover;

    //--
    this.item.appendChild(this.title);
    this.item.appendChild(this.checkBox);
    this.item.appendChild(this.label);
    this.item.appendChild(this.valueLabel);
    this.item.appendChild(this.quantyLabel);
    this.item.appendChild(this.quanty);
    this.item.appendChild(this.deleteBtn);

    this.returnItem = function () {
        return this.item;
    }

    //--
}

//-----------------------------------------------------
/*
CollectionManagerClass will be instantiated to manage all the items 
that are add to the shopping list
*/
function CollectionManagerClass(objcontrolId, consoleobjId,appMainHandler) {
	
	appMainHandler.listCollectionManager = this;
	this.appMainHandler = appMainHandler;
	
	//--
	
	this.control = document.getElementById(objcontrolId);
    this.consoleobj = document.getElementById(consoleobjId);



    this.collectionArray = [];
    this.count = 0;
    this.totalCount = 0;

    this.oneFactor = function (num){
	if (num < 1){ return 1;}else {return num;}
	}
	
    this.addCheck = function () {



        for (var i = 0; i < this.collectionArray.length; i++) {



            if (this.collectionArray[i].checkBoxStatus === true) {

                this.collectionArray[i].item.style.backgroundColor ="#FFcc00"; //"hlightBg";
				appMainHandler.listItemsGroupManager.findById( this.collectionArray[i].id).selectionItem.style.borderColor ="#FFcc00"; 
	

            } else {
                      this.collectionArray[i].item.style.backgroundColor ="#FFF8DC";
					 	appMainHandler.listItemsGroupManager.findById( this.collectionArray[i].id).selectionItem.style.borderColor ="#CCCCCC"; 
            }

        }

    };
    //--
    this.CurrencyFmt = function (amount) {

        var i = parseFloat(amount);
        if (isNaN(i)) {
            i = 0.00;
            return;
        }
        var minus = '';
        if (i < 0) {
            minus = '-';
        }
        i = Math.abs(i);
        i = parseInt((i + .005) * 100);
        i = i / 100;
        var s = new String(i);
        if (s.indexOf('.') < 0) {
            s += '.00';
        }
        if (s.indexOf('.') == (s.length - 2)) {
            s += '0';
        }
		
        s = minus + s;
		return s;
    }
    //------
    this.itemvalueAdded = function (bool) {
        this.totalCount = 0;
        if ((this.collectionArray.length) > 0) {
            for (var i = 0; i < this.collectionArray.length; i++) {
                //alert(this.collectionArray[i].value);
                this.totalCount += parseFloat(this.collectionArray[i].quantyValue(), 10);

                if (i === (this.collectionArray.length - 1)) {

                    //alert(this.totalCount);
					if(bool == true){
						
						  appMainHandler.utilCreateNode(this.consoleobj,"£" + this.CurrencyFmt(this.totalCount));
						}
						
                    return "£" + this.CurrencyFmt(this.totalCount);
                }

            }
        } else {
            return 0;
        }
return 0;
    }
    //--
    this.findById = function (itemId) {

        var itemMatched = 0;
        for (var i = 0; i < this.collectionArray.length; i++) {

            if ((this.collectionArray[i].id) === itemId) {
                itemMatched++;
                return this.collectionArray[i];
            }
            if (i === (this.collectionArray.length - 1) && (itemMatched === 0)) {

                return "notfound";
            }
        }
		return "notfound";
    }
    //--
    this.addItem = function (itemId) {
        var itemMatched = 0;
	
	if ((this.collectionArray.length) > 0) {

            for (var i = 0; i < this.collectionArray.length; i++) {


                if ((this.collectionArray[i].id) === itemId) {
                    itemMatched++;
                }

                if (i === (this.collectionArray.length - 1)) {

                    if (itemMatched === 0) {
                        var customItem = new ListItemsClass(list[itemId], this);
						
                        this.collectionArray.push(customItem);
                       this.control.appendChild(customItem.returnItem());
                        //-- 
                    
   appMainHandler.utilCreateNode( this.consoleobj,this.itemvalueAdded());
                        return;
                        //itemMatched =0;
                    } else if (itemMatched > 0) {
						
                        //alert("This Item is already added to the shopping list \n and the Quantity will be increased");
						
						this.findById(itemId).quantityPlus();
						

                    }
                }

            }
            //-- end of for loop
			 
        } else {
            var customItem = new ListItemsClass(list[itemId], this);
            this.collectionArray.push(customItem);
            this.control.appendChild(customItem.returnItem());
			appMainHandler.utilCreateNode(this.consoleobj,this.itemvalueAdded());
        }
	
	return;

    }
    //---------
    this.removeItem = function (itemId) {



        for (var i = 0; i < this.collectionArray.length; i++) {

            if ((this.collectionArray[i].id) === itemId) {
				
				this.control.removeChild(this.findById(itemId).item)
				
				this.collectionArray.splice(i, 1);
                //-- used remove function from jquery function from jquery;
                
				  appMainHandler.utilCreateNode(this.consoleobj,this.itemvalueAdded());

            }

        }

    }


    this.controller = function () {
        return this.control;
    }
return;

}
//---------------------------------------------
/*--
 SelectionsClass is the class that  will
be instantiated  to create  items that are 
added tio the Shopping selections
takes two @param1 objValue  accepts and object lateral from  the global data source
@param2 accepts an instance of the collectionManager
that is responsible for managing  each items in the Shopping selections
*/

function SelectionsClass(objValue, collectionManager) {
 
	this.id = objValue.id ;
    this.selectionItem = document.createElement('li');
    this.selectionItem.id = objValue.id + "_list";
    this.imageItem = document.createElement('img');
    this.imageItem.src = "http://www.goshine-design.co.uk/expsite/images/thum-" + objValue.imageName;
    this.selectionItem.appendChild(this.imageItem);
 
	this.listNamepItem = document.createElement('p');
	this.listNamepItem.className ="listname";
	collectionManager.appMainHandler.utilCreateNode(this.listNamepItem,objValue.name);
	this.selectionItem.appendChild(this.listNamepItem );
	  
	this.listPricepItem = document.createElement('p');
	this.listPricepItem .className ="price";
    collectionManager.appMainHandler.utilCreateNode(this.listPricepItem,objValue.value); 
	this.selectionItem.appendChild(	this.listPricepItem);
	
   this.button = document.createElement('input');
   this.button.type ='button' ;
   this.button.value ="add to list";
   this.selectionItem.appendChild(this.button); 

    this.selectionItem.onclick = function () {
        collectionManager.addItem(objValue.id);
    }

    this.returnItem = function () {

        return this.selectionItem;
    }
}

//----------------------------------------------


function ListItemsGroupManagerClass(tagetId,collectionData, parallelCollectionManager,appMainHandler) {
	   appMainHandler.listItemsGroupManager = this;
	   this.appMainHandler = appMainHandler;
	   //--
	   this.targetLocation  = document.getElementById(tagetId);
	   this.control = document.createElement("ul");
	   
	   
    this.collectionArray = [];
	this.findById = parallelCollectionManager.findById;
	
    this.count = 0;
    this.totalCount = 0;
	//---
	parallelCollectionManager.reqBind = function(){}
	//
	  this.createConstructor = function (){
	    for (var i in collectionData) {
        // create instance of SelectionsClass items--
        var selectionItem = new SelectionsClass(collectionData[i], parallelCollectionManager);
		this.control.appendChild(selectionItem.returnItem());
		this.collectionArray.push(selectionItem);
		
  		 }
		 
	   this.targetLocation.appendChild(this.control);
	   }
	
}

function ApplicationClass (ListDivId,totalValueId,SelectableItemsId){
"use strict";
	this.name = "Goshine Neat Shopping List";
	this.version = "version 0.1";
	this.utilCreateNode = function(element,textContent){
		var texNode = document.createTextNode(textContent);
		
		if(element.firstChild){
		element.replaceChild(texNode,element.firstChild);
		} else{
			element.appendChild(texNode);
			}
		
		}
	this.init = function(){
this.listCollectionManager = new CollectionManagerClass(ListDivId,totalValueId,this);
this.listItemsGroupManager = new ListItemsGroupManagerClass(SelectableItemsId,list, this.listCollectionManager,this) ;
this.listItemsGroupManager.createConstructor();
		//alert("runing");
		}
		
	}
//---------------------------------------------
window.onload = function () {
var appMain = new ApplicationClass('mainList','priceTotal','selectList');
appMain.init();


//---


};

</script>
</head>

<body>
<div class="colom">
<div id="selectList">
</div>
</div>
<!-- -->
<div class="colomone">
<ul id="mainList">

<li><h2>Cool Shopping List</h2></li>
</ul>
<p class="note">All the these prices are subject to a 50% service charge.</p>
<p> total Value : <span id="priceTotal"></span></p>


</div>


</body>

	
</html>
